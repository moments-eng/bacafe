import json
import os
from flask import g
from langchain_openai import AzureChatOpenAI, AzureOpenAIEmbeddings
from dotenv import load_dotenv
from .fuse_prompt import FusePromptFacade, PromptName
from .mongodb import MongoDBService
from ..models.schemas import ArticleRequest as Article, ReaderRequest as Reader, ArticleResponse, ReaderResponse
from ..utils.logger import logger
from datetime import datetime, timedelta

load_dotenv()

class ProcessService:
    def __init__(self):
        self.fuse_prompt_facade = FusePromptFacade()
        self.mongodb = MongoDBService()

    def get_embedder(self,fuseprompt):
        logger.info(
            "Initializing Embedder",
            extra={
                'request_id': g.request_id,
                'model': fuseprompt.config['model']
            }
        )


        embedder = AzureOpenAIEmbeddings(
            model='text-embedding-3-large',
            azure_endpoint=os.getenv("AZURE_OPENAI_ENDPOINT"),
            openai_api_version='2023-05-15',
        )
        return embedder

    def get_llm(self, fuseprompt):
        logger.info(
            "Initializing LLM",
            extra={
                'request_id': g.request_id,
                'model': fuseprompt.config['model']
            }
        )
        llm = AzureChatOpenAI(
            azure_deployment=fuseprompt.config['model'],
            api_version=os.getenv("OPENAI_API_VERSION"),
            temperature=fuseprompt.config['temperature']
        )
        if 'json_schema' in fuseprompt.config:
            llm = llm.with_structured_output(schema=fuseprompt.config['json_schema'])
        return llm


    def ingest_article(self, article: Article):
        logger.info(
            "Starting article ingestion",
            extra={
                'request_id': g.request_id,
                'article_title': article.title
            }
        )
        
        # Process with LLM
        fuseprompt = self.fuse_prompt_facade.get_prompt(PromptName.ARTICLE_INGEST_CHAT)
        llm = self.get_llm(fuseprompt)
        instructions = self.fuse_prompt_facade.compile_prompt(fuseprompt, **dict(article=article))[0]["content"]
        article_profile = llm.invoke(instructions)

        # Process Embeddings
        fuseprompt_embeddings = self.fuse_prompt_facade.get_prompt(PromptName.ARTICLE_EMBEDDINGS)
        embedder = self.get_embedder(fuseprompt_embeddings)
        embeddings_instructions = self.fuse_prompt_facade.compile_prompt(fuseprompt_embeddings, **article_profile)
        embeddings = embedder.embed_query(embeddings_instructions)
        logger.info(
            "Article ingestion completed",
            extra={
                'request_id': g.request_id,
                'article_title': article.title
            }
        )

        article_profile["embeddings"] = embeddings
        return article_profile

    def ingest_reader(self, reader: Reader):
        logger.info(
            "Starting reader ingestion",
            extra={
                'request_id': g.request_id,
                
            }
        )

        # Process with LLM
        fuseprompt = self.fuse_prompt_facade.get_prompt(PromptName.READER_PROFILER)
        llm = self.get_llm(fuseprompt)
        instructions = self.fuse_prompt_facade.compile_prompt(fuseprompt, **dict(reader=reader))
        reader_profile = llm.invoke(instructions)

        # Process Embeddings
        fuseprompt_embeddings = self.fuse_prompt_facade.get_prompt(PromptName.READER_EMBEDDINGS)
        embedder = self.get_embedder(fuseprompt_embeddings)
        embeddings_instructions = self.fuse_prompt_facade.compile_prompt(fuseprompt_embeddings, **reader_profile)
        embeddings = embedder.embed_query(embeddings_instructions)

        reader_profile["embeddings"] = embeddings

        logger.info(
            "Reader ingestion completed",
            extra={
                'request_id': g.request_id,
            }
        )
        return reader_profile

    def get_daily(self, reader_id):
        now_time = datetime.utcnow()
        last_24_hours = now_time - timedelta(hours=400)
        reader = self.mongodb.get_reader(reader_id)
        query_filter = {
            "createdAt": {
                "$gte": str(last_24_hours),
                "$lte": str(now_time)
            }
        }
        vector_search = {
        '$vectorSearch': {
            'exact': False,
            'index': 'vector_index',
            'path': 'enrichment.embeddings',
            'queryVector': [
      -0.0023769827,
      0.007211159,
      -0.017372515,
      0.009226214,
      -0.0066203373,
      -0.012927656,
      -0.018906305,
      -0.010916513,
      0.007211159,
      0.013718027,
      0.021269593,
      -0.013428485,
      -0.018890655,
      0.03112967,
      0.019970568,
      -0.03192787,
      0.00070184574,
      -0.014391016,
      -0.013968442,
      -0.07662688,
      0.015079657,
      -0.0462015,
      -0.032272186,
      0.026418746,
      0.025119718,
      -0.01504053,
      0.0066399006,
      0.022333857,
      0.008506272,
      0.014226682,
      -0.012364223,
      -0.010540891,
      0.009429676,
      -0.06263496,
      0.004182707,
      -0.003253434,
      0.009226214,
      0.062854074,
      0.038469948,
      -0.018953258,
      0.0024180664,
      -0.025072766,
      -0.028672477,
      -0.010924338,
      0.006549908,
      -0.030644491,
      -0.03969072,
      0.017122101,
      -0.038219534,
      -0.04238268,
      -0.017435119,
      -0.0462015,
      -0.011699059,
      -0.01657432,
      0.04479292,
      -0.020627907,
      0.017200356,
      -0.055811163,
      0.049832515,
      0.020753114,
      -0.023351165,
      -0.016730828,
      0.010885212,
      -0.01726296,
      0.015502231,
      0.00036461742,
      0.0110260695,
      0.027107386,
      -0.025870962,
      -0.035026748,
      -0.003136052,
      0.036059707,
      0.02272513,
      0.018937608,
      -0.011346914,
      -0.026277887,
      0.04670233,
      0.026058774,
      -0.029032448,
      -0.014445795,
      0.009038404,
      0.014555351,
      -0.00008614117,
      0.0063112318,
      0.01828027,
      -0.012669416,
      -0.016668225,
      -0.0940307,
      -0.041068003,
      0.05408956,
      0.029001147,
      -0.028844636,
      -0.033805978,
      -0.01479794,
      0.028437713,
      -0.0025921827,
      -0.017184705,
      -0.011839917,
      0.029235909,
      -0.010611321,
      -0.004374431,
      -0.023335515,
      -0.031771358,
      0.012332921,
      0.047829196,
      0.04363475,
      -0.040880192,
      0.040598474,
      -0.016996894,
      0.032240886,
      -0.011511249,
      -0.011620805,
      -0.04582588,
      -0.029282862,
      -0.013898012,
      -0.00791545,
      0.016496064,
      -0.02341377,
      0.016824733,
      0.0018751753,
      -0.03009671,
      0.0035957978,
      -0.008850592,
      -0.013303278,
      0.00041743924,
      0.02375809,
      -0.007085952,
      0.02017403,
      0.0034979796,
      0.01307634,
      -0.0036603578,
      0.027921233,
      -0.024931908,
      -0.008795815,
      0.019469738,
      -0.00003014024,
      -0.007500701,
      -0.044385996,
      -0.026293537,
      0.03953421,
      0.011033895,
      0.00509046,
      -0.021645216,
      0.020549651,
      0.0045700674,
      -0.0016687788,
      -0.032553904,
      -0.07312108,
      -0.01385106,
      0.00026484282,
      0.030832304,
      -0.003955769,
      -0.010533066,
      0.012293794,
      0.033649467,
      0.0076924246,
      -0.04000374,
      -0.04429209,
      -0.031599198,
      0.009116658,
      -0.030143663,
      -0.014234507,
      0.047265764,
      0.040097646,
      0.023742437,
      -0.012332921,
      -0.002930634,
      -0.017654233,
      -0.010955641,
      0.02616833,
      -0.025589246,
      -0.023304213,
      -0.008694083,
      -0.006749457,
      -0.005407391,
      0.014328413,
      0.029220259,
      -0.0024141537,
      -0.06460698,
      0.04156883,
      -0.021566961,
      -0.010071364,
      -0.0003125292,
      -0.020784415,
      -0.030879255,
      -0.029173305,
      0.033399053,
      -0.0070468243,
      0.014031045,
      0.0065459954,
      0.020643556,
      -0.021973886,
      0.040441964,
      -0.029126354,
      -0.009993109,
      -0.029204607,
      0.033023432,
      -0.016605621,
      0.008584527,
      0.012904179,
      0.005818228,
      -0.0050748093,
      -0.009249691,
      -0.0048322203,
      0.0066399006,
      0.027123036,
      0.0028738992,
      0.0069411807,
      0.04739097,
      -0.006635988,
      0.021332197,
      0.04667103,
      -0.023022497,
      0.039909832,
      0.038094327,
      0.028782032,
      0.0002824501,
      0.008842767,
      0.01593263,
      0.038595155,
      -0.0017656189,
      -0.021520007,
      0.060068212,
      0.006651639,
      0.027999487,
      -0.012825925,
      0.010806957,
      0.008967974,
      -0.006972483,
      -0.024838002,
      -0.0057477984,
      0.017028196,
      -0.040504567,
      0.00023733145,
      -0.011033895,
      0.013999743,
      0.0028797684,
      0.010493939,
      0.009288819,
      -0.049550798,
      0.020080125,
      -0.0046404963,
      -0.007211159,
      -0.0006671203,
      -0.003930336,
      -0.023914598,
      -0.021128735,
      0.08288725,
      -0.028124694,
      0.028077742,
      0.0059356093,
      -0.043697353,
      0.018061155,
      0.022850337,
      0.014015394,
      0.04084889,
      0.0126302885,
      -0.04873695,
      -0.026465697,
      0.03112967,
      -0.0054465183,
      -0.010939989,
      -0.0051530637,
      0.033618167,
      0.016370857,
      0.003940118,
      -0.0005106111,
      -0.012270317,
      0.013232849,
      0.026559602,
      0.014704035,
      -0.0282186,
      -0.00230851,
      -0.0048556966,
      -0.008647131,
      0.010893037,
      0.021269593,
      0.005368264,
      -0.009093182,
      -0.017294262,
      0.0086862575,
      0.0041005397,
      0.028860288,
      -0.02360158,
      -0.0080680465,
      -0.007805894,
      0.020987878,
      -0.074435756,
      0.007371581,
      -0.029658483,
      -0.025417086,
      -0.021660866,
      0.04701535,
      -0.0010564368,
      0.003425594,
      0.03436941,
      0.04889346,
      0.03352426,
      0.023116402,
      -0.02496321,
      0.031567898,
      -0.012786797,
      -0.016308254,
      -0.04141232,
      -0.017575977,
      0.00478918,
      0.03984723,
      0.054120865,
      -0.05590507,
      -0.02940807,
      0.009507931,
      -0.0069216173,
      0.018389825,
      0.025104068,
      0.0018458298,
      0.011268659,
      -0.03026887,
      -0.014140602,
      0.029376768,
      -0.017106451,
      0.036529236,
      0.014876195,
      -0.002163739,
      -0.040817585,
      0.023977201,
      -0.0076963375,
      0.0091792615,
      -0.022756431,
      0.022991193,
      0.033211242,
      -0.0050239437,
      0.022161696,
      -0.007868498,
      0.023194656,
      -0.0039635943,
      0.007907625,
      -0.024869304,
      0.0026352229,
      0.0299089,
      -0.04122451,
      -0.03674835,
      -0.031239226,
      0.0213948,
      0.018436778,
      0.015533533,
      0.010947815,
      -0.051335003,
      0.012043379,
      0.044855524,
      0.0030675794,
      0.0010045931,
      0.052962698,
      0.019547993,
      0.020674858,
      0.03693616,
      -0.02037749,
      0.006651639,
      0.005927784,
      -0.0022772083,
      0.045888484,
      0.025902264,
      -0.017137753,
      -0.0069646575,
      0.047735292,
      -0.0012413132,
      -0.091964774,
      -0.009484455,
      -0.0029169393,
      -0.020220982,
      0.011722536,
      -0.04037936,
      0.0022380808,
      0.018327221,
      -0.013530216,
      0.018092457,
      -0.019798407,
      0.0034979796,
      0.009390549,
      -0.006291668,
      0.014688384,
      0.01009484,
      -0.025604896,
      0.031427037,
      0.024196316,
      -0.031536594,
      0.046076294,
      -0.0022635136,
      -0.014375365,
      -0.009554883,
      -0.0059434352,
      -0.0080680465,
      -0.0050748093,
      -0.006213413,
      -0.009163611,
      0.017544676,
      0.024884956,
      0.0137336785,
      0.06867622,
      0.012904179,
      -0.025698803,
      0.00509046,
      -0.0019240844,
      -0.005626504,
      -0.007845021,
      0.043853864,
      -0.02018968,
      0.006855101,
      -0.046420615,
      -0.025917916,
      -0.0143518895,
      0.0080093555,
      0.03853255,
      0.019579295,
      0.026872622,
      0.032553904,
      0.03194352,
      0.012849402,
      0.047797896,
      -0.039221194,
      -0.025370134,
      -0.03408769,
      0.045512863,
      0.018217666,
      -0.012638114,
      -0.064074844,
      0.023726787,
      0.03455722,
      -0.04072368,
      0.011894695,
      -0.039941136,
      -0.009359247,
      0.008960149,
      0.021973886,
      -0.020909622,
      0.010791306,
      -0.045074634,
      -0.028030789,
      0.0042061834,
      0.013952791,
      0.032585204,
      -0.01641781,
      -0.03405639,
      -0.044667713,
      -0.035026748,
      -0.0014731424,
      0.013796282,
      0.0039264234,
      0.0016629098,
      0.024180664,
      -0.027060432,
      -0.021660866,
      -0.0053056604,
      -0.023398118,
      0.010932164,
      0.0041905325,
      -0.023398118,
      0.011683408,
      -0.009852251,
      0.010822608,
      -0.036529236,
      -0.00881929,
      0.006002126,
      0.048549138,
      -0.031145321,
      -0.012215539,
      0.0059434352,
      0.032240886,
      -0.015001402,
      0.018749796,
      0.011910346,
      -0.023210308,
      -0.018499382,
      -0.03850125,
      0.005524773,
      0.007911538,
      0.0145397,
      -0.013686725,
      -0.015056181,
      0.023476373,
      0.005712584,
      0.023523325,
      -0.03286692,
      0.046451915,
      0.020643556,
      0.010760004,
      0.021300895,
      0.0001562646,
      -0.042476583,
      0.0020972227,
      -0.027655168,
      0.020267935,
      0.039252494,
      0.009304469,
      0.015181388,
      -0.006189937,
      0.02393025,
      -0.028609874,
      -0.06542083,
      -0.00067445665,
      -0.013584995,
      0.017106451,
      0.017529026,
      0.029861946,
      0.026121378,
      -0.014117125,
      -0.0042061834,
      0.023366816,
      -0.010102666,
      -0.015423977,
      -0.0055286856,
      -0.0035175432,
      0.04000374,
      -0.02785863,
      -0.019078465,
      0.02203649,
      0.011746012,
      0.020784415,
      0.025417086,
      -0.003231914,
      -0.007931101,
      0.0020307063,
      -0.021645216,
      -0.011746012,
      0.02530753,
      -0.01693429,
      -0.01986101,
      0.0019279971,
      -0.012786797,
      -0.042664394,
      0.00418662,
      0.036247518,
      0.010118317,
      -0.03130183,
      0.039784625,
      0.027279545,
      -0.017669883,
      0.026058774,
      0.012739845,
      -0.005102198,
      -0.019782757,
      -0.0060216896,
      -0.008302811,
      -0.013898012,
      0.003989027,
      0.012066856,
      -0.0034138558,
      -0.0049574273,
      -0.009594011,
      -0.00061283115,
      -0.014015394,
      -0.0239459,
      -0.016018711,
      -0.023851994,
      -0.016042188,
      -0.028281204,
      -0.020033171,
      0.017513374,
      0.028828986,
      0.005743886,
      -0.038595155,
      0.032240886,
      -0.020831369,
      0.012035553,
      -0.0138588855,
      -0.008138476,
      -0.016136093,
      -0.012739845,
      -0.0013821714,
      -0.009093182,
      -0.02496321,
      -0.010533066,
      0.0057360604,
      -0.0158309,
      -0.014977925,
      0.015408326,
      0.02411806,
      -0.010274826,
      -0.029517626,
      0.03214698,
      -0.016355207,
      0.043572146,
      -0.0021872155,
      0.013115467,
      0.02037749,
      0.01707515,
      -0.015635265,
      -0.029048098,
      -0.011894695,
      -0.020847019,
      0.01624565,
      0.008412367,
      0.0598178,
      0.012896354,
      -0.03059754,
      -0.046608426,
      -0.013498914,
      0.01879675,
      0.008412367,
      -0.010267001,
      -0.0718064,
      -0.011965125,
      0.019735804,
      -0.004053587,
      0.016292602,
      -0.021066131,
      -0.018014204,
      0.014406667,
      0.0016071533,
      -0.023288561,
      0.023225958,
      -0.01257551,
      -0.0035390633,
      -0.007774592,
      -0.026277887,
      -0.0053017475,
      -0.0026058774,
      0.03518326,
      0.035151955,
      -0.023319863,
      -0.01846808,
      -0.011409517,
      -0.022615572,
      0.054026958,
      0.008991451,
      0.02018968,
      0.02461889,
      0.007195508,
      0.007723727,
      -0.005767362,
      0.031333134,
      0.0179516,
      0.031176623,
      -0.019516692,
      0.006952919,
      -0.020205332,
      0.014610129,
      0.030331474,
      -0.014750987,
      0.011127801,
      0.028813334,
      -0.00478918,
      0.008248032,
      -0.01950104,
      0.024994511,
      -0.020659208,
      0.0033962487,
      -0.0021891717,
      0.0069763954,
      0.00957836,
      -0.056343295,
      0.00224395,
      0.013663249,
      0.0025080591,
      0.04397907,
      0.026121378,
      -0.005767362,
      -0.012825925,
      0.038094327,
      -0.008075872,
      -0.019532342,
      -0.007970229,
      -0.0028269466,
      -0.0029991067,
      -0.0067338063,
      -0.02598052,
      -0.010102666,
      -0.00992268,
      0.013318929,
      0.011049546,
      -0.0478918,
      -0.009014927,
      0.0025100156,
      -0.008021094,
      0.017403817,
      -0.00671033,
      0.029548928,
      -0.036341425,
      0.027232593,
      -0.023382468,
      0.007629821,
      -0.013232849,
      -0.02069051,
      -0.012606812,
      -0.034306806,
      -0.01726296,
      -0.0084358435,
      0.007555479,
      -0.0010691532,
      -0.007042912,
      -0.021660866,
      0.009101007,
      0.02393025,
      0.00233003,
      -0.002555012,
      0.0063816607,
      -0.0071289917,
      0.008506272,
      0.02241211,
      0.00069597666,
      -0.025730105,
      -0.041318417,
      0.005556075,
      0.028155996,
      0.038250837,
      -0.015345722,
      -0.0049261255,
      -0.016276952,
      -0.014993576,
      -0.011534724,
      -0.011339088,
      -0.012419001,
      0.03677965,
      0.011824266,
      0.0041005397,
      0.0022146045,
      -0.0146023035,
      -0.013287627,
      0.010713051,
      -0.04257049,
      -0.0011317568,
      0.007402883,
      -0.009640964,
      0.0026313101,
      -0.032397393,
      -0.04807961,
      0.011315611,
      0.019939266,
      0.0036857906,
      0.02975239,
      0.001658997,
      -0.0049261255,
      -0.043728657,
      -0.0041357544,
      -0.0055169477,
      0.018906305,
      -0.019579295,
      -0.018342873,
      0.02704478,
      0.007172032,
      0.004409645,
      0.017716836,
      -0.015995236,
      0.012771146,
      0.0065812096,
      0.006115595,
      0.022631222,
      0.016981242,
      0.0028915065,
      -0.035997104,
      -0.017935948,
      -0.016370857,
      -0.0096722655,
      0.045137238,
      -0.008960149,
      0.0056969333,
      0.007445923,
      0.0026234847,
      0.0018595244,
      0.014813591,
      0.012285968,
      -0.023288561,
      -0.005196104,
      -0.013757154,
      -0.035464972,
      0.033837277,
      0.01436754,
      -0.0015132478,
      -0.048517838,
      -0.010360906,
      -0.021833027,
      -0.027091734,
      0.015126609,
      0.017028196,
      -0.0032299575,
      0.0076532974,
      -0.0017362734,
      -0.0041357544,
      -0.0044800746,
      -0.009210563,
      0.006780759,
      -0.032929525,
      -0.010478288,
      0.027733421,
      0.017810741,
      0.023570279,
      -0.011409517,
      0.04138102,
      -0.011566026,
      0.020737462,
      -0.028296854,
      0.029533276,
      -0.014234507,
      -0.0205027,
      -0.013091991,
      0.03796912,
      -0.016996894,
      0.014234507,
      0.0059669116,
      0.029220259,
      0.012935481,
      -0.018248968,
      -0.019469738,
      -0.0023593754,
      0.008725385,
      0.005536511,
      -0.00007666503,
      -0.002598052,
      -0.023538977,
      -0.01402322,
      0.013999743,
      0.00030372557,
      -0.015455279,
      0.04394777,
      0.052712284,
      -0.0056578056,
      -0.007426359,
      -0.004503551,
      0.00031644193,
      0.00052870746,
      0.011902521,
      -0.030425379,
      0.013545867,
      0.029517626,
      -0.0041748816,
      0.014070173,
      0.012481605,
      0.002871943,
      0.00653817,
      0.015525708,
      0.005916046,
      -0.022286903,
      0.0019514735,
      0.012880703,
      0.008858418,
      -0.02393025,
      0.01197295,
      0.0028915065,
      0.0014076042,
      0.0048243944,
      0.053776544,
      -0.008842767,
      -0.015330072,
      -0.0022772083,
      -0.0008529749,
      -0.030566238,
      0.005442606,
      -0.0089366725,
      -0.0056343293,
      0.015650915,
      0.011925997,
      -0.0021520008,
      -0.00461702,
      0.028281204,
      -0.021081783,
      -0.018671542,
      -0.03059754,
      -0.020205332,
      0.012262492,
      0.004030111,
      -0.007602432,
      0.003204525,
      0.0031125757,
      -0.030190615,
      -0.032240886,
      0.01000876,
      -0.03696746,
      -0.0053487,
      -0.040410664,
      0.012794623,
      -0.030034106,
      0.016198697,
      -0.021786073,
      0.029799342,
      0.011816441,
      0.026810018,
      0.010243524,
      0.009022753,
      -0.030941859,
      -0.000112001864,
      -0.036810953,
      -0.027483007,
      0.018092457,
      0.005411304,
      -0.032397393,
      0.014946624,
      -0.040254153,
      0.009711393,
      -0.00040863562,
      0.013976268,
      -0.007762854,
      0.027467357,
      -0.009007102,
      0.018828051,
      -0.016089141,
      -0.02785863,
      0.019234974,
      -0.010423509,
      0.0038403433,
      -0.01154255,
      -0.0037660014,
      0.017231658,
      -0.00066418573,
      0.007989792,
      -0.02087832,
      -0.034275506,
      0.00701161,
      0.015783949,
      -0.012442478,
      0.015236166,
      0.020565303,
      0.0010270913,
      -0.011033895,
      0.032929525,
      -0.051241096,
      0.0009850295,
      0.014211031,
      0.01018092,
      -0.011659931,
      0.007672861,
      -0.004601369,
      -0.012833751,
      -0.012105983,
      -0.027107386,
      0.044855524,
      0.004026198,
      -0.000063153886,
      0.024399776,
      -0.005352613,
      0.012849402,
      -0.0034529832,
      -0.0034236377,
      0.0035312378,
      0.022897288,
      0.0022028664,
      -0.000058110138,
      0.0037327432,
      -0.0036427504,
      0.020033171,
      -0.009977458,
      -0.04742227,
      0.0393464,
      -0.027295196,
      0.029564578,
      -0.027389102,
      -0.011104324,
      -0.014391016,
      0.014516224,
      -0.010126142,
      0.0129980855,
      0.008827116,
      0.014375365,
      0.0017196443,
      -0.02172347,
      0.020299237,
      0.014649256,
      -0.002120699,
      -0.0196732,
      -0.03972202,
      -0.024243267,
      0.030738397,
      0.023006845,
      0.022803383,
      -0.012176412,
      -0.0106974,
      -0.017873345,
      0.0023476372,
      0.015862202,
      -0.014234507,
      -0.02120699,
      0.009993109,
      -0.020768763,
      -0.012082507,
      -0.011104324,
      0.0043431288,
      0.0052274056,
      0.034494616,
      0.001240335,
      -0.021347849,
      -0.040629774,
      0.01488402,
      -0.011237357,
      0.021629564,
      0.011996427,
      -0.029940201,
      -0.0033884232,
      -0.038689062,
      -0.0078254575,
      -0.0043040016,
      0.015736995,
      0.023742437,
      -0.01896891,
      -0.013271976,
      -0.0080680465,
      0.0248067,
      0.013561518,
      0.027483007,
      -0.01762293,
      -0.00015846551,
      -0.011049546,
      -0.03559018,
      -0.0282186,
      -0.027780375,
      0.034400713,
      0.023585929,
      0.0066007734,
      0.010893037,
      -0.03812563,
      0.004386169,
      -0.008725385,
      -0.0033727721,
      0.039565515,
      -0.0019573425,
      -0.04016025,
      0.015768297,
      0.0031067065,
      0.0010887168,
      0.018029854,
      -0.01643346,
      -0.0032769104,
      0.0081932545,
      -0.011143452,
      -0.01848373,
      0.011558201,
      -0.026434395,
      0.017059498,
      -0.0069607445,
      -0.0010446986,
      0.008921022,
      0.019547993,
      -0.00260979,
      -0.032053076,
      0.0057751876,
      0.013600646,
      -0.0018908262,
      0.024321523,
      -0.052806187,
      -0.001562157,
      0.01050959,
      -0.020267935,
      0.0032651722,
      0.010916513,
      0.019923614,
      0.005106111,
      0.006988134,
      0.018749796,
      -0.0064364388,
      -0.02001752,
      0.019626247,
      0.012559859,
      0.0070037846,
      -0.011417342,
      -0.0040222853,
      0.009257516,
      -0.0026391356,
      0.014899671,
      0.02310075,
      -0.01760728,
      -0.030754048,
      0.014571002,
      0.0057204096,
      0.007633734,
      -0.0064168754,
      -0.0009419895,
      0.013358056,
      -0.02651265,
      -0.01779509,
      0.037217878,
      -0.011378216,
      -0.017669883,
      0.011479946,
      -0.00821673,
      -0.0010984986,
      0.024243267,
      -0.010713051,
      0.020737462,
      -0.0077980687,
      -0.032647807,
      -0.008052396,
      0.017388167,
      -0.0021050482,
      0.0058104023,
      0.0034862414,
      0.023382468,
      0.018561985,
      -0.019751456,
      -0.005066984,
      -0.024869304,
      -0.02086267,
      0.030707095,
      -0.03796912,
      -0.020064473,
      -0.00059522386,
      -0.00017350506,
      0.036216218,
      -0.0019906007,
      -0.00010154754,
      0.018217666,
      0.05387045,
      -0.012685067,
      0.0033003867,
      -0.032804318,
      -0.00051501294,
      0.0030147575,
      0.0006460893,
      -0.033837277,
      0.02651265,
      -0.0047578784,
      0.03972202,
      0.013045038,
      -0.003065623,
      -0.0213948,
      0.012716369,
      0.02206779,
      0.004127929,
      0.02429022,
      -0.01879675,
      0.0015915025,
      -0.013381532,
      0.015807424,
      -0.033305146,
      -0.011879045,
      0.011010419,
      -0.0031536594,
      -0.011879045,
      0.0004338238,
      0.006690766,
      -0.0083184615,
      0.021989536,
      0.0030949684,
      -0.007974141,
      -0.0014897715,
      0.0034881977,
      0.013209373,
      0.040441964,
      -0.019015862,
      -0.0031556159,
      -0.01641781,
      -0.023022497,
      -0.0028269466,
      0.0029756303,
      -0.0324913,
      -0.00015773188,
      -0.0196732,
      -0.013303278,
      -0.0066712024,
      -0.015854377,
      -0.0027389103,
      0.0008451494,
      0.016464762,
      0.008967974,
      -0.020487048,
      -0.008208905,
      0.022177346,
      -0.0013176114,
      -0.0060412535,
      0.04222617,
      0.007586781,
      -0.005160889,
      -0.007923276,
      -0.01828027,
      -0.025291879,
      -0.022552969,
      0.0032827794,
      -0.019579295,
      0.0033199503,
      -0.011839917,
      0.00065146934,
      -0.044918127,
      0.005223493,
      0.006577297,
      -0.0070898645,
      0.001637477,
      0.005149151,
      0.011135627,
      -0.027608214,
      -0.022052139,
      -0.0010231786,
      0.031333134,
      -0.022631222,
      -0.01025135,
      -0.018014204,
      0.0066046864,
      -0.0012735932,
      -0.011323437,
      -0.013091991,
      -0.011088673,
      -0.031520944,
      -0.01129996,
      0.020314887,
      -0.00063777476,
      -0.026794367,
      0.010517415,
      -0.0024630628,
      -0.01658997,
      -0.014015394,
      -0.011307786,
      -0.017497724,
      -0.015431803,
      -0.01445362,
      0.021097433,
      0.001771488,
      0.01162863,
      -0.0023378555,
      0.017294262,
      -0.00517654,
      0.00021446645,
      -0.007845021,
      0.01514226,
      0.0007013566,
      0.009531408,
      0.010063538,
      -0.029674135,
      0.012935481,
      -0.009312294,
      -0.044761617,
      0.012849402,
      0.011253008,
      -0.035527576,
      0.010580019,
      -0.014571002,
      -0.016323904,
      -0.004953515,
      -0.006158635,
      0.017153403,
      -0.016402159,
      -0.003200612,
      0.022991193,
      0.02494756,
      0.00880364,
      -0.010689575,
      0.016511716,
      0.00089894945,
      -0.004691362,
      0.0014643387,
      0.000928784,
      0.03286692,
      0.016026538,
      0.014304937,
      0.010313953,
      -0.0046091946,
      0.02530753,
      0.013624121,
      -0.01402322,
      -0.038063027,
      0.014062347,
      -0.0039909836,
      0.021081783,
      0.0025217538,
      -0.049707305,
      0.0066985916,
      0.011730361,
      -0.014312762,
      0.016464762,
      -0.015009227,
      -0.000055481272,
      0.007989792,
      0.0004900693,
      -0.0019681025,
      -0.008647131,
      -0.005364351,
      0.013311103,
      -0.000009858242,
      0.014860544,
      0.004804831,
      0.066422485,
      -0.029142004,
      -0.030738397,
      -0.026716111,
      -0.0039694635,
      0.017920299,
      0.011472121,
      -0.0016169351,
      0.01205903,
      0.03834474,
      0.018546334,
      -0.013686725,
      -0.022130394,
      0.008529749,
      -0.0055130348,
      -0.00504742,
      0.019782757,
      0.011073022,
      -0.02120699,
      0.001959299,
      -0.02787428,
      0.006146897,
      -0.001261855,
      -0.0033199503,
      -0.019031513,
      -0.0114016915,
      0.037374385,
      0.003108663,
      0.014977925,
      -0.007555479,
      0.0062251515,
      -0.0018321353,
      0.02704478,
      -0.004707013,
      0.033993788,
      -0.0071759447,
      0.000092743896,
      0.0070937774,
      -0.01231727,
      0.0080093555,
      -0.0032710412,
      0.015596137,
      0.01514226,
      0.01643346,
      0.02513537,
      0.01898456,
      0.00030348104,
      -0.018452428,
      0.0072502866,
      -0.006632075,
      -0.009914855,
      0.0023202482,
      0.005466082,
      0.015846552,
      -0.0007101603,
      -0.00245915,
      -0.026137028,
      -0.019876663,
      -0.000531642,
      -0.009155786,
      -0.025354482,
      0.02666916,
      0.021003528,
      -0.001734317,
      -0.024384126,
      -0.002690001,
      0.019234974,
      0.0043979073,
      0.0050004674,
      -0.017137753,
      -0.017137753,
      -0.004037936,
      -0.0031340958,
      0.0014418405,
      -0.034588523,
      -0.013506739,
      0.015001402,
      -0.005501297,
      -0.000103626175,
      -0.013217198,
      -0.00045314291,
      0.0158309,
      0.010196571,
      0.0170908,
      -0.015064006,
      0.026653508,
      -0.01676213,
      -0.00013560051,
      0.034244202,
      0.00020003825,
      0.005959086,
      -0.028594222,
      -0.0014418405,
      -0.02241211,
      -0.0007351039,
      0.009515757,
      0.011237357,
      -0.036153615,
      -0.00077227486,
      -0.021410452,
      -0.0037620887,
      -0.009280993,
      -0.0043783435,
      -0.023898948,
      0.004084889,
      -0.00907753,
      0.00248067,
      -0.008138476,
      -0.0089758,
      0.013193722,
      -0.008482796,
      -0.0012031641,
      0.0010270913,
      -0.020471398,
      0.01829592,
      0.016276952,
      -0.018781098,
      0.031599198,
      0.0042727,
      0.0036055795,
      0.014187555,
      -0.008294985,
      0.019907964,
      -0.0030186702,
      -0.00813065,
      -0.003274954,
      -0.008310636,
      -0.00037880105,
      0.021660866,
      0.0048283073,
      0.002421979,
      -0.0076376465,
      0.011659931,
      -0.0029560665,
      0.022615572,
      -0.010791306,
      -0.018702844,
      -0.020909622,
      -0.0012129459,
      -0.033837277,
      0.001583677,
      0.00081629306,
      0.010368731,
      0.008592352,
      -0.010838259,
      -0.02823425,
      0.017669883,
      -0.027749073,
      0.010321778,
      -0.009460978,
      0.006142984,
      0.0150874825,
      0.013483264,
      -0.016104791,
      -0.014265809,
      0.019188022,
      -0.0021030917,
      -0.012395524,
      0.018671542,
      -0.012958958,
      0.0021050482,
      0.0048243944,
      -0.003914685,
      -0.026481349,
      -0.013209373,
      0.015721343,
      -0.032209583,
      0.015236166,
      0.018061155,
      0.006479479,
      0.012904179,
      -0.009171437,
      0.0019348444,
      -0.02119134,
      -0.021598263,
      -0.02582401,
      -0.011417342,
      0.012215539,
      -0.0074889627,
      0.00012520733,
      0.009539233,
      0.0061116824,
      -0.008396716,
      -0.009367073,
      -0.026747415,
      0.008482796,
      -0.012270317,
      -0.009155786,
      0.004124016,
      0.0064716535,
      0.01981406,
      0.013131117,
      0.02482235,
      -0.0015748733,
      0.015173562,
      0.0444486,
      0.013577169,
      -0.013232849,
      -0.0047226637,
      0.010000935,
      -0.019407135,
      0.015384849,
      0.010235699,
      0.009852251,
      0.0016179134,
      -0.026450047,
      -0.014821417,
      -0.009210563,
      0.007027261,
      -0.0104078585,
      0.035026748,
      0.005798664,
      -0.026481349,
      -0.0121294595,
      -0.01658997,
      0.0073363665,
      0.018436778,
      -0.017873345,
      -0.023366816,
      0.000044415585,
      -0.014641431,
      -0.019563643,
      -0.01828027,
      -0.03812563,
      -0.024775399,
      -0.00020541826,
      -0.0008583549,
      0.015384849,
      0.009601836,
      -0.028343808,
      0.019720154,
      -0.0035194994,
      0.009218389,
      0.009343596,
      0.042883508,
      0.036717046,
      0.0032260448,
      0.0032612595,
      0.01266159,
      0.0041787946,
      -0.004800918,
      0.014211031,
      -0.019923614,
      -0.0000070345054,
      -0.0016991025,
      -0.009938331,
      0.032084376,
      -0.033273846,
      0.013029387,
      0.012763321,
      -0.011573852,
      -0.014445795,
      -0.004084889,
      0.015948283,
      -0.0037386124,
      -0.019939266,
      0.0074811373,
      0.000039524675,
      -0.0011855569,
      -0.024556287,
      -0.0106582735,
      -0.021253943,
      0.000073057985,
      0.017544676,
      0.008967974,
      0.0050004674,
      0.006573384,
      -0.008404542,
      -0.018921956,
      -0.0029188956,
      0.012825925,
      -0.0076806867,
      0.017294262,
      -0.019438436,
      -0.02787428,
      -0.003977289,
      0.034212902,
      -0.00671033,
      -0.033242542,
      0.010603495,
      0.0020600518,
      -0.0049848165,
      -0.014657082,
      0.014140602,
      -0.009953982,
      -0.0036055795,
      0.011487772,
      0.033211242,
      -0.0050395946,
      0.020283585,
      0.02274078,
      -0.01760728,
      0.0013029387,
      -0.010728702,
      -0.022865986,
      0.01605784,
      0.010000935,
      0.006949006,
      0.02206779,
      0.0042100963,
      0.016104791,
      -0.004632671,
      -0.012387699,
      0.04156883,
      0.009382724,
      0.006448177,
      0.00011267436,
      -0.004409645,
      -0.039784625,
      0.00487526,
      0.02546404,
      0.024024155,
      -0.014610129,
      -0.015893504,
      0.012685067,
      -0.0064168754,
      -0.016480414,
      0.015431803,
      -0.008263683,
      0.020565303,
      0.029220259,
      0.0031712668,
      -0.018264618,
      0.015697869,
      0.006213413,
      -0.0038266487,
      0.00028367282,
      -0.019579295,
      -0.007258112,
      -0.019547993,
      0.024556287,
      0.008553226,
      0.014062347,
      0.008388891,
      -0.010517415,
      0.011143452,
      0.028140346,
      0.00045730016,
      0.010306127,
      0.014946624,
      0.01565874,
      -0.0058808313,
      -0.004601369,
      -0.00521958,
      -0.0012569642,
      -0.0070507373,
      0.00521958,
      0.0057908385,
      0.002195041,
      0.013373707,
      -0.0019182153,
      0.017904647,
      0.0020170116,
      -0.004237485,
      0.003059754,
      0.0068277116,
      -0.01300591,
      0.01676213,
      0.0016022625,
      -0.017669883,
      0.011566026,
      -0.006835537,
      -0.00440182,
      -0.012027728,
      -0.0066281627,
      -0.0017568152,
      -0.015455279,
      -0.0019289753,
      -0.00012502391,
      0.0069059664,
      0.007833283,
      -0.0009385658,
      -0.02430587,
      0.0023691573,
      0.010431335,
      0.0063151442,
      0.022427762,
      0.023147704,
      0.0052821836,
      0.008185429,
      -0.0138667105,
      -0.00048664564,
      0.025510991,
      -0.0074067954,
      -0.007974141,
      -0.005857355,
      0.006260366,
      -0.009953982,
      0.0042609614,
      -0.0022909027,
      -0.005673457,
      -0.008913197,
      -0.007649385,
      0.016981242,
      0.014657082,
      0.01197295,
      -0.0006485348,
      -0.0064168754,
      0.003355165,
      -0.005223493,
      0.029142004,
      -0.018202014,
      -0.016543018,
      -0.0010349167,
      0.015134435,
      -0.0009816058,
      0.027889932,
      0.008858418,
      -0.025213623,
      -0.0035018923,
      -0.016308254,
      -0.020408792,
      0.008357589,
      0.009304469,
      -0.01607349,
      -0.016636923,
      0.0023887209,
      -0.018327221,
      0.04322783,
      0.011832092,
      0.019000212,
      -0.011605154,
      -0.002212648,
      0.0008329221,
      0.02103483,
      0.02203649,
      0.0055599874,
      0.001175775,
      -0.016965592,
      -0.012771146,
      -0.0016678006,
      0.004922213,
      0.029533276,
      -0.003108663,
      -0.014242332,
      -0.021269593,
      -0.017247308,
      -0.012285968,
      -0.030331474,
      -0.006049079,
      0.01896891,
      -0.006894228,
      -0.0028152084,
      -0.00821673,
      0.005313486,
      -0.009194912,
      -0.009257516,
      0.013811933,
      -0.020471398,
      0.015024878,
      0.0031321393,
      0.0018125717,
      0.021269593,
      -0.004327478,
      -0.012591161,
      0.0027741247,
      0.0025256665,
      0.00022424827,
      -0.008514098,
      -0.01605784,
      -0.027498659,
      0.0065303445,
      -0.010212222,
      -0.008201079,
      0.015103133,
      -0.004992642,
      0.006142984,
      -0.0097974725,
      0.01050959,
      -0.010525241,
      -0.026074424,
      0.011925997,
      0.008834941,
      -0.015603962,
      -0.011307786,
      -0.0069450936,
      0.03405639,
      -0.005274358,
      -0.0024493681,
      -0.012935481,
      0.009734869,
      -0.0059434352,
      0.016167395,
      0.0060686423,
      0.01050959,
      0.0064168754,
      -0.015690042,
      0.005352613,
      0.0070350864,
      -0.0030049756,
      0.013498914,
      -0.01514226,
      0.012677241,
      0.024650192,
      -0.026215283,
      -0.029220259,
      0.0040966272,
      -0.004691362,
      -0.008600178,
      0.00813065,
      -0.0047187507,
      0.0139840925,
      -0.0035312378,
      0.023147704,
      0.011182579,
      -0.0136789,
      0.0080093555,
      -0.0068042353,
      -0.015870027,
      -0.007919363,
      -0.017842043,
      -0.011675582,
      -0.008279334,
      -0.0273578,
      0.0051882784,
      0.0096722655,
      -0.0012853314,
      -0.00213635,
      0.018045506,
      -0.009687916,
      -0.008044571,
      0.00068179297,
      -0.0069450936,
      -0.007974141,
      -0.02806209,
      0.037155274,
      -0.00074830937,
      0.011065197,
      -0.017982902,
      -0.020283585,
      0.0040770634,
      0.0036388377,
      -0.0089366725,
      -0.013154594,
      -0.014563177,
      -0.013718027,
      0.031348784,
      -0.021300895,
      0.011245183,
      -0.01917237,
      0.006502955,
      -0.019767106,
      -0.01982971,
      0.0052469694,
      0.011612979,
      0.0022380808,
      -0.0137415035,
      -0.03521456,
      -0.0031966993,
      -0.012426826,
      0.029032448,
      -0.005426955,
      -0.005051333,
      0.008114999,
      0.00478918,
      0.0037640452,
      -0.023460722,
      -0.0062799295,
      -0.0072033335,
      -0.0059669116,
      0.0017646407,
      0.009218389,
      -0.009625313,
      0.023805043,
      0.019516692,
      0.01693429,
      -0.021253943,
      -0.000034817174,
      -0.03389988,
      0.0066712024,
      -0.046764936,
      0.004847871,
      -0.0024904518,
      0.008944498,
      0.0004639029,
      0.012888528,
      0.003940118,
      0.011049546,
      0.004503551,
      -0.0006314166,
      -0.00041181472,
      0.0068277116,
      -0.020972226,
      0.0031380085,
      -0.0037346997,
      -0.00053995656,
      0.010306127,
      0.00040985833,
      0.020095775,
      -0.0032612595,
      0.003542976,
      -0.001648237,
      -0.0038149105,
      -0.013326754,
      -0.021598263,
      0.003586016,
      0.027216941,
      -0.0038286052,
      -0.018593287,
      -0.014171904,
      -0.0038149105,
      0.019954916,
      -0.008654956,
      0.000076053664,
      -0.0021011354,
      -0.008709734,
      -0.009680091,
      0.0022478628,
      -0.002259601,
      0.015697869,
      0.0056617185,
      -0.0043392163,
      0.024994511,
      -0.0019769063,
      0.0016286734,
      0.0052860966,
      -0.019422786,
      -0.023382468,
      0.018202014,
      0.002948241,
      -0.008005443,
      0.006401224,
      0.015870027,
      -0.012223365,
      0.006025602,
      0.018342873,
      -0.010548716,
      0.007864585,
      0.0034823287,
      -0.0022889464,
      0.010212222,
      0.007555479,
      0.0009860076,
      0.003656445,
      -0.014586653,
      0.014320588,
      0.021848677,
      0.0047383145,
      -0.003871645,
      0.005771275,
      -0.0053291367,
      0.027514309,
      0.0034158123,
      -0.0023182917,
      0.022834685,
      0.0044761617,
      0.011237357,
      -0.0018908262,
      0.016026538,
      -0.02259992,
      0.0043040016,
      0.02890724,
      -0.016668225,
      -0.013029387,
      0.013209373,
      -0.013999743,
      0.00045705563,
      -0.0239459,
      0.003151703,
      0.001975928,
      0.041161906,
      0.0016453024,
      -0.010063538,
      -0.0021441753,
      0.008271509,
      -0.009163611,
      0.008138476,
      0.0038031724,
      -0.0010104622,
      -0.0037640452,
      -0.0023711137,
      -0.017826393,
      0.0012520732,
      -0.018671542,
      0.0061821113,
      0.00399294,
      -0.017012544,
      0.02494756,
      0.009773997,
      -0.0011933823,
      0.021473056,
      0.0013684769,
      0.004546591,
      0.0073402794,
      0.010016586,
      0.0019485389,
      -0.013037212,
      -0.0068042353,
      0.0059786495,
      0.005536511,
      -0.017732486,
      -0.008075872,
      -0.017419469,
      -0.0055091223,
      -0.011323437,
      -0.0077354647,
      -0.000934164,
      -0.03850125,
      0.000432112,
      0.00666729,
      0.010024412,
      0.0031751795,
      0.0013459787,
      0.0029012884,
      -0.018953258,
      0.008357589,
      0.025870962,
      0.01658997,
      0.02444673,
      0.0022928591,
      0.005970824,
      -0.018233316,
      0.016793432,
      -0.0011522986,
      0.0062681916,
      0.0083184615,
      -0.008514098,
      0.0011787096,
      0.003548845,
      0.008756687,
      0.012113809,
      0.021003528,
      0.0024356737,
      -0.00025041465,
      -0.027060432,
      -0.008263683,
      0.020424444,
      -0.0007854803,
      0.0048987363,
      -0.0006759239,
      0.007821545,
      0.0012051205,
      0.009022753,
      -0.0018223535,
      0.017012544,
      -0.009460978,
      0.00923404,
      0.0015328116,
      0.012896354,
      0.0062838425,
      0.0069450936,
      -0.002126568,
      0.0048126564,
      0.004562242,
      -0.019391485,
      -0.021300895,
      -0.009468804,
      0.0066555515,
      0.01643346,
      0.007121166,
      0.005927784,
      -0.035997104,
      0.0084436685,
      0.0018194189,
      -0.022005187,
      -0.008725385,
      0.005571726,
      -0.018358523,
      -0.024540635,
      -0.0049183,
      0.013553693,
      -0.0013058733,
      -0.011245183,
      -0.0047031,
      0.0041357544,
      -0.0015533533,
      0.0010280695,
      -0.008428018,
      0.017137753,
      0.018342873,
      -0.003253434,
      -0.0023045973,
      -0.0030421466,
      -0.013428485,
      0.006988134,
      -0.0020326625,
      -0.023711136,
      -0.0042296597,
      0.007211159,
      0.00552086,
      0.0053604385,
      -0.014641431,
      0.022506015,
      0.026215283,
      -0.009773997,
      0.016777782,
      -0.018734146,
      0.004049674,
      -0.0014995533,
      0.0033590777,
      -0.007179857,
      0.0079506645,
      0.017529026,
      -0.004726576,
      -0.0027291283,
      -0.001615957,
      0.025182322,
      -0.00881929,
      0.010517415,
      -0.009860077,
      -0.008248032,
      -0.021238292,
      0.005798664,
      0.006706417,
      -0.014555351,
      0.009014927,
      -0.00509046,
      0.017294262,
      -0.011839917,
      -0.031207925,
      0.013185896,
      -0.01419538,
      0.012419001,
      0.010533066,
      0.02361723,
      -0.010548716,
      -0.021582613,
      0.012958958,
      0.009899204,
      -0.003955769,
      0.0008519967,
      -0.004515289,
      0.00504742,
      0.0012853314,
      0.010877386,
      -0.014680559,
      0.02189563,
      -0.006518606,
      0.01865589,
      -0.008005443,
      -0.0007199421,
      -0.0021461318,
      -0.03471373,
      0.011597328,
      0.0015856334,
      -0.00007966071,
      0.003844256,
      0.0045661544,
      0.0051530637,
      0.0016795389,
      0.019547993,
      -0.017982902,
      -0.021942584,
      0.0066868537,
      -0.018499382,
      -0.0063386206,
      0.004049674,
      0.012481605,
      0.0003790456,
      -0.0038286052,
      0.0055130348,
      0.0060647298,
      0.005861268,
      -0.026074424,
      -0.022427762,
      0.012152935,
      0.009398375,
      -0.0013831496,
      -0.015181388,
      -0.0072972393,
      0.0077863303,
      -0.022693828,
      -0.0065303445,
      -0.0060764677,
      -0.013827584,
      0.024571937,
      -0.0025628374,
      -0.010486113,
      0.0044565983,
      0.005297835,
      0.009226214,
      -0.009476629,
      -0.007230723,
      0.018875003,
      -0.0041161906,
      -0.013193722,
      -0.02120699,
      -0.014077998,
      -0.005442606,
      -0.0222243,
      0.008263683,
      -0.002856292,
      0.01984536,
      -0.0011425168,
      -0.020252284,
      0.018671542,
      -0.029126354,
      0.012411175,
      0.013506739,
      0.020487048,
      -0.00017754007,
      0.010611321,
      0.023225958,
      -0.0019583208,
      -0.0043939943,
      -0.0022674263,
      0.024024155,
      -0.0053447876,
      0.009171437,
      -0.009625313,
      -0.00004212297,
      0.018546334,
      0.010345255,
      0.019062815,
      0.00066760933,
      -0.005368264,
      0.005423042,
      -0.017544676,
      0.007665036,
      -0.018233316,
      0.024399776,
      0.016793432,
      0.013569344,
      -0.0063229697,
      0.0065616462,
      0.0022361246,
      0.009648789,
      0.0010848041,
      -0.019547993,
      -0.009202738,
      0.00075955846,
      0.0026978266,
      0.040254153,
      0.011738187,
      -0.035684086,
      0.0022185172,
      0.008052396,
      -0.020940924,
      -0.00521958,
      0.010681749,
      -0.011151277,
      0.006287755,
      -0.0019729936,
      -0.016339555,
      -0.031567898,
      -0.007535916,
      0.00047906474,
      0.000015062477,
      0.015854377,
      -0.009187087,
      -0.0011170841,
      -0.014007569,
      -0.015306595,
      0.00015161824,
      -0.003098881,
      -0.004761791,
      0.01273202,
      -0.000120133,
      0.020831369,
      -0.010047887,
      -0.008787989,
      0.013608471,
      0.0025530555,
      -0.016558668,
      0.016558668,
      0.016809084,
      0.0017489898,
      -0.015478755,
      -0.0039283796,
      -0.011722536,
      -0.0265283,
      -0.005031769,
      0.021926932,
      0.0012608769,
      0.003945987,
      0.0046052816,
      -0.0057477984,
      -0.0127554955,
      -0.0196732,
      -0.0051530637,
      -0.017388167,
      0.0029110701,
      0.007042912,
      -0.0071642064,
      0.011847743,
      -0.015181388,
      0.018937608,
      0.008122825,
      0.027420403,
      -0.037875216,
      -0.004656147,
      0.027827326,
      0.008224556,
      -0.029188957,
      -0.029501975,
      -0.017169055,
      -0.00418662,
      -0.016715178,
      -0.0043235654,
      -0.016308254,
      -0.004515289,
      0.016777782,
      0.013686725,
      -0.014156253,
      0.00043406835,
      -0.026966527,
      0.009374898,
      0.017200356,
      -0.013530216,
      0.004225747,
      0.0056421547,
      -0.0064364388,
      -0.0000026556118,
      0.0012814187,
      -0.010713051,
      0.008255858,
      0.020643556,
      0.010392208,
      0.0121372845,
      -0.002056139,
      0.006307319,
      0.01931323,
      0.0011571895,
      -0.018342873,
      0.02119134,
      0.02940807,
      0.004628758,
      -0.024352824,
      0.019047163,
      0.019375833,
      -0.0011102367,
      0.006213413,
      -0.0047774417,
      0.00504742,
      0.00975052,
      0.0085610505,
      -0.01555701,
      -0.003629056,
      0.0029893247,
      -0.019469738,
      0.004726576,
      0.01428146,
      -0.00802892,
      0.01205903,
      0.004761791,
      -0.00015345233,
      -0.009883553,
      0.008060222,
      0.009805298,
      -0.0050004674,
      -0.0015856334,
      0.0170908,
      0.0051882784,
      -0.037718706,
      0.024008503,
      -0.009421851,
      0.022646874,
      -0.02036184,
      -0.00023879873,
      -0.00038638196,
      -0.004562242,
      0.014750987,
      -0.009226214,
      -0.018608939,
      0.014680559,
      -0.01522834,
      -0.01000876,
      0.00048835744,
      0.006334708,
      0.009265342,
      -0.0012354441,
      -0.016511716,
      0.01981406,
      0.0041318415,
      -0.0025726191,
      -0.014617954,
      0.009359247,
      0.0026939139,
      -0.0114016915,
      0.0042648744,
      0.017137753,
      0.021660866,
      -0.022537317,
      0.0062799295,
      0.017920299,
      -0.006213413,
      0.01864024,
      0.016824733,
      0.01865589,
      0.0021089609,
      -0.003597754,
      0.011761663,
      -0.018921956,
      0.000029651148,
      -0.0014320588,
      -0.021566961,
      0.016183047,
      0.009007102,
      0.009531408,
      0.008921022,
      0.010634797,
      -0.003730787,
      -0.005955173,
      0.017732486,
      -0.025510991,
      0.005012206,
      -0.002195041,
      0.005873006,
      0.01815506,
      0.010869561,
      -0.020753114,
      -0.01676213,
      -0.009914855,
      -0.009241865,
      -0.011096499,
      -0.0005438693,
      0.012278143,
      0.0071642064,
      -0.031442687,
      0.01043916,
      -0.01018092,
      -0.014617954,
      -0.010728702,
      0.034776334,
      0.013170245,
      -0.0002169119,
      -0.011010419,
      -0.003662314,
      -0.020471398,
      0.00066907663,
      0.007856759,
      0.0070194355,
      0.006851188,
      0.0042492235,
      0.015110958,
      0.0047109253,
      0.01266159,
      0.0035136305,
      0.014359714,
      -0.010971292,
      -0.0052156677,
      0.0023867646,
      -0.013162419,
      0.019000212,
      -0.027263895,
      -0.011386041,
      -0.007367668,
      -0.011659931,
      -0.009171437,
      0.0036857906,
      -0.005426955,
      0.019328881,
      0.007876323,
      0.022020837,
      -0.00003558138,
      -0.007426359,
      -0.025996171,
      -0.0017000807,
      0.0027291283,
      0.010947815,
      0.013052863,
      -0.0031223577,
      0.008960149,
      0.015118784,
      -0.005200017,
      0.00007892708,
      0.0039596814,
      -0.0061390717,
      0.005837791,
      -0.0020091862,
      -0.005900395,
      0.0121294595,
      0.01162863,
      -0.0065616462,
      0.00521958,
      0.006025602,
      -0.011652106,
      0.009210563,
      -0.0018702843,
      -0.006706417,
      0.002948241,
      0.012778972,
      0.00821673,
      0.022709478,
      -0.005669544,
      -0.02037749,
      -0.022521667,
      -0.0036877468,
      -0.012160761,
      0.010556542,
      0.013999743,
      -0.004155318,
      -0.0081932545,
      -0.00079232757,
      -0.00096791127,
      0.02461889,
      -0.010423509,
      -0.012442478,
      -0.005857355,
      -0.020111427,
      0.0037425251,
      0.023351165,
      0.0035586269,
      0.0066399006,
      0.02378939,
      -0.0021520008,
      -0.0030949684,
      0.0055482495,
      -0.009468804,
      0.01059567,
      0.00096008583,
      0.032773018,
      0.020549651,
      -0.020596605,
      -0.007027261,
      -0.0024571936,
      0.0018800662,
      -0.0012980477,
      -0.0027741247,
      -0.0084436685,
      0.007535916,
      0.005380002,
      -0.008341937,
      -0.009860077,
      -0.0034764595,
      0.0046052816,
      -0.006405137,
      0.0015132478,
      0.00095421675,
      0.002948241,
      0.003049972,
      0.008459319,
      -0.008138476,
      -0.008717559,
      0.019297577,
      0.0037660014,
      0.0020757027,
      -0.0006597839,
      0.01846808,
      -0.008521923,
      0.004538765,
      -0.006350359,
      0.0033942922,
      0.0016795389,
      -0.0062994934,
      0.0023789392,
      -0.010986943,
      -0.0109086875,
      -0.026590904,
      0.015909156,
      0.0069020535,
      0.00035410197,
      -0.022568619,
      0.008553226,
      0.005008293,
      -0.015165737,
      -0.041349716,
      0.016621271,
      0.004546591,
      -0.019250626,
      -0.01777944,
      -0.0008153149,
      0.003306256,
      -0.009742695,
      -0.01745077,
      -0.011088673,
      0.01763858,
      0.020346189,
      0.019250626,
      -0.017904647,
      -0.0026352229,
      -0.03631012,
      -0.006894228,
      0.004300089,
      -0.004879173,
      -0.016856035,
      -0.006060817,
      -0.00739897,
      -0.010478288,
      0.01548658,
      0.002533492,
      -0.008122825,
      0.014461446,
      0.007790243,
      -0.007852847,
      0.009116658,
      0.012387699,
      -0.009241865,
      -0.0017881171,
      0.005207842,
      -0.010423509,
      -0.005481733,
      0.01162863,
      0.010157444,
      -0.0010368731,
      -0.0045935437,
      -0.013381532,
      -0.030018454,
      -0.0068472754,
      0.033931185,
      0.008208905,
      -0.007328541,
      -0.011323437,
      0.018170713,
      -0.0059669116,
      -0.0019133243,
      -0.002721303,
      -0.031145321,
      -0.0046091946,
      0.03283562,
      0.017826393,
      -0.0064990427,
      -0.014985751,
      -0.0025217538,
      -0.009734869,
      0.01018092,
      0.030534936,
      0.00837324,
      0.00047441837,
      0.017153403,
      -0.02203649,
      -0.00024723556,
      -0.010016586,
      -0.00847497,
      -0.0042687873,
      0.002163739,
      0.016089141,
      -0.0045309397,
      -0.014414493,
      -0.0005707693,
      0.0034510267,
      0.0017900735,
      -0.00006309275,
      0.005352613,
      0.0055482495,
      0.0107834805,
      -0.022130394,
      0.0006773912,
      0.0015504188,
      0.0002677774,
      0.024853652,
      0.0107756555,
      -0.035809293,
      -0.0048713475,
      -0.013780631,
      0.007688512,
      0.0038559942,
      0.005927784,
      0.016355207,
      -0.010838259,
      -0.003822736,
      -0.0068864026,
      -0.021003528,
      0.006291668,
      -0.0003929847,
      -0.010525241,
      -0.004155318,
      0.008255858,
      0.013772805,
      -0.00504742,
      0.022130394,
      0.02684132,
      -0.019360183,
      0.0029521538,
      -0.008842767,
      0.0021070044,
      -0.010415684,
      0.015416152,
      0.006248628,
      -0.0074850502,
      -0.0004930038,
      0.006103857,
      0.01917237,
      0.0058299657,
      -0.005149151,
      0.009101007,
      0.012692892,
      -0.003730787,
      -0.010822608,
      0.0042687873,
      -0.007402883,
      -0.009327945,
      -0.0047383145,
      0.028124694,
      0.0145944785,
      0.0056069405,
      0.0089366725,
      0.012512906,
      -0.021081783,
      0.0055052093,
      0.027154338,
      -0.00029834558,
      0.0008769403,
      0.0045348527,
      -0.012778972,
      -0.004902649,
      0.0076572103,
      -0.015353547,
      0.0121372845,
      0.0029188956,
      0.011957299,
      -0.000109372995,
      0.006420788,
      -0.0062290644,
      0.0073754936,
      -0.0007864585,
      -0.013608471,
      0.0030206267,
      -0.012301619,
      0.0069059664,
      -0.026700461,
      -0.0112764845,
      -0.026872622,
      -0.014766638,
      0.020940924,
      0.0077824173,
      0.017935948,
      -0.026230933,
      0.0034216812,
      -0.02375809,
      -0.0019729936,
      -0.008647131,
      0.010220048,
      0.010087015,
      0.009500106,
      0.018749796,
      -0.023163354,
      0.0138667105,
      0.023445072,
      0.0003377174,
      -0.0030577974,
      -0.006518606,
      0.0051530637,
      0.007195508,
      0.02241211,
      0.015330072,
      0.010830433,
      0.019610597,
      0.0062955804,
      -0.020393142,
      0.016151745,
      0.01137039,
      -0.022208648,
      -0.004785267,
      0.019751456,
      0.014437969,
      0.016449112,
      0.0027193464,
      -0.0149701005,
      0.0072189844,
      -0.027827326,
      0.007500701,
      0.0028523793,
      0.0015875897,
      0.010705226,
      -0.027279545,
      0.021488706,
      0.01231727,
      0.004483987,
      0.0043235654,
      0.01504053,
      0.0013195678,
      -0.020549651,
      0.0006974439,
      0.006248628,
      -0.0027623866,
      0.0073363665,
      -0.03299213,
      -0.0053017475,
      0.0068668392,
      -0.008772338,
      -0.0046091946,
      -0.02000187,
      0.01815506,
      -0.02000187,
      -0.0022752518,
      -0.028954193,
      -0.00036412833,
      0.017106451,
      -0.012348572,
      0.037906516,
      0.02274078,
      -0.0006201675,
      0.0056382422,
      -0.00075711304,
      0.022255601,
      -0.0063542714,
      0.00881929,
      0.002367201,
      -0.010689575,
      -0.012536383,
      0.012325096,
      0.0134910885,
      0.0054152166,
      0.0094062,
      -0.010994768,
      0.022318205,
      0.0045113764,
      0.016167395,
      0.005873006,
      -0.00044898564,
      -0.010830433,
      -0.0017196443,
      -0.0054465183,
      0.015377024,
      0.0055599874,
      0.0040927143,
      -0.03659184,
      -0.0069920463,
      -0.024978861,
      -0.023523325,
      0.026121378,
      0.0047735292,
      -0.0016012843,
      0.0010388294,
      0.007672861,
      -0.010603495,
      0.0023163354,
      0.018953258,
      -0.009515757,
      -0.01326415,
      -0.0067768465,
      0.0059238714,
      0.00881929,
      -0.0014428188,
      0.004675711,
      0.014946624,
      -0.0026723938,
      -0.018734146,
      0.0020424444,
      -0.022646874,
      -0.003832518,
      0.0162613,
      -0.0025843573,
      -0.024008503,
      -0.0061938497,
      0.013811933,
      -0.0033140813,
      -0.01205903,
      -0.008083697,
      0.020612255,
      0.008521923,
      0.0015484624,
      -0.0036955723,
      0.018734146,
      -0.0072972393,
      -0.008944498,
      0.0027956448,
      -0.008490621,
      0.010861735,
      0.0036427504,
      -0.02482235,
      0.019109767,
      0.009007102,
      0.0037053542,
      -0.0004991175,
      0.022537317,
      -0.0003800238,
      -0.025557945,
      -0.0022791645,
      0.03368077,
      0.0023045973,
      -0.017482072,
      0.0012158805,
      -0.014226682,
      -0.0010828477,
      -0.006909879,
      0.01641781,
      -0.016668225,
      0.015173562,
      0.010877386,
      0.0006050057,
      -0.010979117,
      0.01050959,
      0.0053604385,
      0.016871687,
      -0.005610853,
      -0.014844893,
      0.028860288,
      -0.017169055,
      0.018530684,
      0.027498659,
      -0.003998809,
      0.003924467,
      0.012285968,
      0.00025212645,
      0.022537317,
      0.0067298934,
      0.0073050647,
      -0.013749329,
      -0.011534724,
      0.018624589,
      -0.0035527577,
      0.006608599,
      0.008201079,
      0.0044487724,
      0.0010857822,
      0.0018908262,
      0.0056578056,
      0.029173305,
      0.0019426699,
      0.027983837,
      -0.006424701,
      -0.002062008,
      0.007970229,
      -0.007121166,
      0.003854038,
      0.00030079103,
      -0.018327221,
      -0.023272911,
      0.0067729335,
      0.0040457617,
      -0.008741036,
      0.0033766849,
      0.047547482,
      -0.0057595368,
      0.008905371,
      0.015995236,
      -0.006984221,
      -0.0043783435,
      -0.002400459,
      0.023476373,
      -0.0050278567,
      -0.0096644405,
      0.005743886,
      0.01693429,
      0.011863394,
      0.0023887209,
      -0.0072776754,
      -0.0017382298,
      0.0010065495,
      -0.01307634,
      0.006463828,
      0.002212648,
      0.007575043,
      -0.018076807,
      -0.011699059,
      -0.011753838,
      0.0009517713,
      0.016605621,
      -0.029611532,
      -0.014375365,
      0.0060921186,
      -0.0042805253,
      0.0063386206,
      -0.006819886,
      -0.013138943,
      -0.006725981,
      0.0109086875,
      0.0074107083,
      0.00057419296,
      0.020080125,
      -0.02598052,
      -0.011503423,
      0.0064168754,
      -0.010360906,
      0.015017053,
      -0.003887296,
      0.004914387,
      -0.0014907497,
      0.0025256665,
      0.01180079,
      0.020346189,
      -0.0104078585,
      0.002099179,
      -0.01846808,
      0.005395653,
      0.009218389,
      0.010893037,
      0.0056069405,
      0.0273578,
      -0.009257516,
      0.006479479,
      0.012090332,
      -0.0027526047,
      -0.02482235,
      0.013577169,
      0.0007551567,
      -0.0019182153,
      0.024540635,
      -0.008811465,
      0.004425296,
      -0.002056139,
      0.0017587716,
      0.0179516,
      -0.004949602,
      -0.010986943,
      -0.0017480116,
      0.023022497,
      -0.011573852,
      -0.0065694717,
      -0.02375809,
      -0.012395524,
      -0.012677241,
      0.0014310805,
      -0.014101475,
      0.024884956,
      -0.015173562,
      0.021222642,
      -0.016042188,
      0.012215539,
      -0.019015862,
      -0.015275293,
      0.012082507,
      0.01119823,
      0.009140135,
      -0.005426955,
      0.011268659,
      0.009899204,
      0.026403094,
      -0.0070742136,
      0.010564367,
      -0.0061077694,
      -0.0041905325,
      -0.007085952,
      0.05164802,
      0.0064325263,
      -0.0028973757,
      -0.007426359,
      -0.0012569642,
      -0.0051413258,
      -0.0078176325,
      0.0037229615,
      0.014915322,
      0.012035553,
      0.009351422,
      0.01035308,
      0.005035682,
      -0.011605154,
      -0.018421127,
      -0.017200356,
      -0.012168586,
      0.019203672,
      -0.016151745,
      -0.0038696888,
      0.03148964,
      -0.002920852,
      -0.024728445,
      0.014297111,
      -0.00679641,
      0.011065197,
      -0.00037831196,
      -0.0145944785,
      -0.008185429,
      0.023883296,
      0.014586653,
      0.004499638,
      -0.0016893207,
      0.032006122,
      0.008161952,
      -0.008138476,
      -0.0046248455,
      0.0013694551,
      0.0070037846,
      0.00653817,
      0.019657549,
      -0.030660143,
      -0.00696857,
      0.008897545,
      -0.014140602,
      0.00068472757,
      -0.0030480158,
      0.00012850869,
      -0.007477225,
      -0.024603238,
      -0.02017403,
      0.008827116,
      0.0014046696,
      -0.006448177,
      0.021144386,
      -0.011346914,
      -0.0033297322,
      -0.021942584,
      -0.0089758,
      0.00881929,
      0.00213635,
      -0.009515757,
      0.029314164,
      -0.019720154,
      -0.0076376465,
      -0.005380002,
      -0.012825925,
      -0.010000935,
      0.014250158,
      0.0014105387,
      0.016527366,
      0.004409645,
      0.0026137028,
      0.032366093,
      0.017888997,
      -0.004296176,
      -0.009108833,
      0.003521456,
      -0.0063777477,
      -0.021848677,
      0.013843235,
      0.021347849,
      0.0018771316,
      0.014038871,
      -0.030754048,
      -0.0015425934,
      0.0023417682,
      -0.002314379,
      -0.0065851226,
      0.0036310123,
      0.0017216007,
      0.015627438,
      -0.014766638,
      -0.025855312,
      0.012724194,
      0.015377024,
      0.0019945134,
      -0.0071876827,
      -0.0016580188,
      0.024102408,
      -0.02087832,
      0.010642623,
      0.001304895
    ],#reader['embeddings'],
            "filter": query_filter,
            'numCandidates': 400,
            'limit': 30
        }
    }

        # Combine the query filter and vector search
        pipeline = [
            vector_search,
            {
                '$project': {
                        '_id': 0,
                        'url': 1,
                        "title": "$enrichment.title",
                        "summary": "$enrichment.summary"
                    }
            }
        ]
        articles = self.mongodb.db.articles.aggregate(pipeline)
        reader["relevant_articles"] = articles
        fuseprompt = self.fuse_prompt_facade.get_prompt(PromptName.DAILY_DIGEST)
        llm = self.get_llm(fuseprompt)
        instructions = self.fuse_prompt_facade.compile_prompt(fuseprompt, **reader)
        daily_digest = llm.invoke(instructions)
        return daily_digest
